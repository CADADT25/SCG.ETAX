@{
    Layout = null;
}
<div class="misc-wrapper">
    <div class="row">
        <div class="col-xl-4 col-md-6 col-12 mb-1" style="margin-bottom:0rem !important">
            <div class="form-group">
                <label>Request No.</label>
                <input type="text" id="allRequestNo" class="form-control" placeholder="Request number." />
            </div>
        </div>
        <div class="col-xl-4 col-md-6 col-12 mb-1">
            <div class="form-group">
                <label for="helpInputTop">Select action</label>
                <select class="select2 form-control" id="allAction" multiple>
                    <option value="" disabled hidden>--- Select action ---</option>
                    <option value="@Variable.RequestActionCode_Delete">Delete</option>
                    <option value="@Variable.RequestActionCode_Undelete">Undelete</option>
                    <option value="@Variable.RequestActionCode_ReSignNewTrans">Re-Sign PDF XML (Workaround)</option>
                    <option value="@Variable.RequestActionCode_ReSignNewCert">Re-Sign PDF XML (New cert)</option>
                    @*<option value="unzip">Unzip</option>*@
                </select>
            </div>
        </div>
        <div class="col-xl-4 col-md-6 col-12 mb-1">
            <div class="form-group">
                <label for="helpInputTop">Select status</label>
                <select class="select2 form-control" id="allStatus" multiple>
                    <option value="" disabled hidden>--- Select action ---</option>
                    <option value="@Variable.RequestStatusCode_WaitAdminCheck">Wait Admin</option>
                    <option value="@Variable.RequestStatusCode_WaitManager">Wait Manager</option>
                    <option value="@Variable.RequestStatusCode_WaitOfficer">Wait Officer</option>
                    <option value="@Variable.RequestStatusCode_Complete" selected>Complete</option>
                    <option value="@Variable.RequestStatusCode_Reject">Reject</option>
                </select>
            </div>
        </div>
        <div class="col-xl-4 col-md-4 col-6 mb-1"></div>
        <div class="col-xl-4 col-md-4 col-6 mb-1">
            <div class="form-group">
                <a class="btn btn-primary btn-block" onclick="fnSearchAll();"> Search </a>
            </div>
        </div>
        <div class="col-xl-4 col-md-4 col-6 mb-1"></div>

    </div>

    <div class="mb-0 table-responsive">
        <table class="table table-striped table-hover-animation table-hover" id="tbAllMain" style="font-size:12px;padding-bottom:15px;">
            <thead style="font-size:10px">
                <tr>
                    @*<th></th>*@
                    <th style="font-size:10px">Request No.</th>
                    <th style="font-size:10px">Company</th>
                    <th style="font-size:10px">Action</th>
                    <th style="font-size:10px">Status</th>
                    <th style="font-size:10px">Manager</th>
                    <th style="font-size:10px">Reqeuster</th>
                    <th style="font-size:10px">Request Date</th>
                    @*<th style="font-size:10px">Action</th>*@
                    <th style="font-size:10px">History</th>
                </tr>
            </thead>
        </table>
    </div>

</div>

<script type="text/javascript">
    var allTrick = 0;
    $(document).ready(function () {
        $('#allAction').select2();
        $('#allStatus').select2();

        //fnSearchAll();
    });

    function fnSearchAllClick() {
        if (allTrick == 0) {
            fnSearchAll();
            allTrick = 1;
        }
    }

    function fnSearchAll() {
        var table = $('#tbAllMain').DataTable();
        table.clear().draw();
        table.destroy();

        var getRequestNo = $('#allRequestNo').val();
        var getStatus = $('#allStatus').val();
        var getAction = $('#allAction').val();
        var model = new Object();

        model.EmailUser = $("#leftSideEmail").text();
        model.RequestNo = getRequestNo;
        model.RequestAction = getAction;
        model.RequestStatus = getStatus;

        var JsonString = JSON.stringify(model);

        $('[data-toggle="tooltip"]').tooltip();

        var table = $("#tbAllMain").DataTable({

            "scrollY": false,
            "processing": true, // for show progress bar
            "serverSide": false, // for process server side
            "filter": true, // this is for disable filter (search box)
            "orderMulti": true, // for disable multiple column at once
            "pageLength": 50,
            "scrollX": true,

            "ajax": {
                url: "@Url.Action("SearchAll", "InboxAll")",
                type: "POST",
                data: { jsonString: JsonString },
                dataType: "json"
            },


            "columns": [

                //{
                //    width: "2%",
                //    render: function (data, type, full, meta) {
                //        return '<input type="checkbox" class="req-checkboxes" name="id[]" value="' + $('<div/>').text(data).html() + '">';
                //    }
                //},
                {
                    data: "requestNo",
                    width: "10%",
                    render: function (data, type, row) {
                        return '<span class="text-primary" onclick="fnRenderViewRequest(\'' + data + '\')">' + data + '</span>';
                    }
                },
                {
                    data: "companyCode",
                    width: "10%"
                },
                {
                    data: "requestAction",
                    width: "10%",
                    render: function (data, type, row) {
                        return fnCheckAction(data);
                    }
                },
                {
                    data: "statusCode",
                    width: "10%",
                    render: function (data, type, row) {
                        return fnCheckStatus(data);
                    }
                },
                {
                    data: "managerName",
                    width: "10%"
                },
                {
                    data: "requesterName",
                    width: "10%"
                },
                {
                    data: "requestDate",
                    width: "10%",
                    render: function (data, type, row, meta) {
                        return moment(data).format('DD-MM-YYYY HH:mm');
                    }
                },
                //{
                //    width: "10%",
                //    render: function (data, type, full, meta) {
                //        return 'Action';
                //    }
                //},
                {
                    data: "requestId",
                    width: "10%",
                    render: function (data, type, full, meta) {
                        return '<button type="button" class="btn btn-warning btn-sm waves-effect waves-float waves-light"  onclick="fnSearchHistoryModal(\'' + data + '\')">View</button>';
                    }
                }
            ]
        });
    }

</script>